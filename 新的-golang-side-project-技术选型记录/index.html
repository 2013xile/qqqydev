<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="沉默入海"><link rel="shortcut icon" href=https://qqqy.dev/favicon.ico><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Noto+Serif+SC&display=swap" media=print onload='this.media="all"'><link rel=stylesheet href=/css/style.min.css><link rel=canonical href=https://qqqy.dev/%E6%96%B0%E7%9A%84-golang-side-project-%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B%E8%AE%B0%E5%BD%95/><link href=https://cdn.bootcdn.net/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css rel=stylesheet><script src=https://cdn.bootcdn.net/ajax/libs/highlight.js/11.7.0/highlight.min.js></script>
<script>hljs.initHighlightingOnLoad()</script><title>新的 Golang side project 技术选型记录</title></head><body><header id=banner><h2><a href=https://qqqy.dev>沉海记</a></h2><nav><ul><li><a href=/categories/ title=categories>categories</a></li><li><a href=/about/ title=about>about</a></li><li><a href=/resume/ title=résumé>résumé</a></li></ul></nav></header><main id=content><article><header id=post-header><h1>新的 Golang side project 技术选型记录</h1><div><time>September 10, 2023</time></div></header><blockquote><p>打算利用工作之余的时间，写一个 side project, 简单记录一下前期的选型对比。</p></blockquote><h1 id=语言-go>语言 <code>Go</code></h1><p>这个 project 主要目标还是一个偏Web类的应用，这类应用用 JS 来撸肯定是最快最爽的，但是因为工作中的主要语言就是 JS，所以想换换口味。在上一份工作里有一半时间是写 Go 的，离职以后已经很久没用了，也不能荒废了，之前的工作写的也是偏业务功能的代码居多，没有很深入研究 Go, 所以想趁此机会捡起来一些。Go 用于开发Web应用也是比较不错的。而且我这个项目最终大概率是一个在本地运行居多的东西，我又不太想做成一个桌面应用，理想情况是利用一个可执行文件启动应用服务以后，用本地浏览器做应用载体，当然这个文件最终也可以打包成各个平台的软件包。Go的话利用 <code>go:embed</code> 可以很方面地把前端产物打到最终的二进制文件里。综合上述几点原因，最终选择的开发语言是 <strong>Go</strong>.</p><h1 id=web框架-fiber>Web框架 <code>fiber</code></h1><p>我对Web框架的要求基本上就是能处理 <code>router</code> 和 <code>handler</code> 就可以，Go 在这方面的库和轮子太多了，用过<a href=https://github.com/gin-gonic/gin>gin</a>和<a href=https://github.com/gorilla/mux>mux</a>, 甚至我觉得简单的场景 Go 自带的 <code>http</code> 库也能用用。好像现在<a href=https://github.com/gofiber/fiber>fiber</a> 还挺流行的，看了介绍，&ldquo;Express inspired web framework&rdquo;, 这个我熟，就它了。</p><h1 id=orm框架-bun>ORM框架 <code>Bun</code></h1><p>前面都比较顺利，在 ORM 框架选择上，费了不少功夫。其实在以前我基本上很少用ORM框架，最多用 query builder 库来拼 SQL。我要做的这个应用可能会有兼容多数据库的需要，所以写 raw sql 不太现实，也不能把时间都花在做 sql 兼容适配上，所以大概还是需要这么个东西。<br>本来我是想用以前我用的挺好的一个 query builder 的库 <a href=https://github.com/doug-martin/goqu>goqu</a>, 但是看 Github 上面的代码最新提交已经是2年前了，比较想选择一个相对活跃的库，另外就是我还需要 <em>migration</em> 的功能，这个库也没有。<br>在 <a href=https://awesome-go.com/>awesome-go</a> 上看了一圈，发现 query builder 的库基本上都不带 <em>migration</em> 功能，也想过用 query builder 库 + migration 库，但是很多单独的 <code>migration</code> 库都是通过写 raw sql 来做的，没有实现不同数据库的兼容。
最后还是只能回头来看 ORM, <a href=https://xorm.io/>xorm</a> 和 <a href=https://gorm.io/>gorm</a> 我是用过的，基本上我对这两东西是拒绝的，很多东西太重了，还有光定义 <code>Model</code> 和转换输出就麻烦。<a href=https://github.com/ent/ent>ent</a> 算是另一种层面的 ORM ，但是看了下文档，感觉代码还是很冗杂，本质上没有降低写代码的心智负担。<br>反反复复看了看，还真让我找到一个比较合适的—— <a href=https://bun.uptrace.dev/>bun</a>. 用法上基本是一个 query builder, 没有各种复杂的 Relation 需要定义，兼容常见的数据库，支持 <em>migration</em> 功能，更新也比较活跃。不过具体体验还得用了才知道。</p></article><script src=https://giscus.app/client.js data-repo=2013xile/qqqydev data-repo-id=R_kgDOJHBOqg data-category=Comments data-category-id=DIC_kwDOJHBOqs4CXwE5 data-mapping=title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async></script></main><footer id=footer>Copyright © 2023 YANG QIA</footer></body></html>